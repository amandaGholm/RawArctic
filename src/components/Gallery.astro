---
import { Image } from "astro:assets";
import Casper from "../assets/images/casper.webp";
import CampImage from "../assets/images/campsite.png";
import OverskyetLandskab from "../assets/images/overskyetLandskab.webp";
import PigeFisk from "../assets/images/pigeFisk.webp";
import IsakHolderFisk from "../assets/images/isakHolderFisk.webp";
import UdvidetFisk from "../assets/images/udvidetFisk.webp";
import BøjetFisk from "../assets/images/BøjetFisk.webp";
---

<section class="common">
  <div class="gallery-container">
    <div class="wrapper">
      <Image src={BøjetFisk} alt="Fluefisker paa Grønland" class="galleryIMG" />
    </div>
    <div class="wrapper">
      <Image src={Casper} alt="Fluefisker paa Grønland" class="galleryIMG" />
    </div>
    <div class="wrapper">
      <Image
        src={IsakHolderFisk}
        alt="Fluefisker paa Grønland"
        class="galleryIMG"
      />
    </div>
    <div class="wrapper">
      <Image src={CampImage} alt="Fluefisker paa Grønland" class="galleryIMG" />
    </div>
  </div>

  <div class="gallery-container2">
    <div class="wrapper2">
      <Image
        src={OverskyetLandskab}
        alt="Fluefisker paa Grønland"
        class="IMG galleryIMG"
      />
    </div>
    <div class="wrapper2">
      <Image
        src={PigeFisk}
        alt="Fluefisker paa Grønland"
        class="IMG galleryIMG pigeFisk"
      />
    </div>
    <div class="wrapper2">
      <Image
        src={UdvidetFisk}
        alt="Fluefisker paa Grønland"
        class="IMG galleryIMG presentFisk"
      />
    </div>
  </div>
</section>

<script>
  import { gsap } from "gsap";
  import { ScrollTrigger } from "gsap/ScrollTrigger";
  gsap.registerPlugin(ScrollTrigger);
  // -------------------------------------------------------- Gallery --------------------------------------------------------

  document.addEventListener(
    "DOMContentLoaded",
    () => {
      const wrappers = document.querySelectorAll(".wrapper");
      const wrapper2 = document.querySelectorAll(".wrapper2");

      let totalWidth = 0;
      let totalWidth2 = 0;
      const windowWidth = window.innerWidth;
      let scrollDistance;

      if (windowWidth < 800) {
        // Mobile
        scrollDistance = 2000; // Set the scroll distance for mobile
      } else {
        // Desktop
        scrollDistance = 3000;
      }

      // Udregning af den samlede bredde mellem content og viewport
      wrappers.forEach((wrapper) => {
        totalWidth += (wrapper as HTMLElement).offsetWidth;
      });
      wrapper2.forEach((wrapper) => {
        totalWidth2 += (wrapper as HTMLElement).offsetWidth;
      });

      // Giver den rigtige længde animationen skal vare for at det passer med billeder
      const amountToScroll = totalWidth - window.innerWidth;
      const amountToScroll2 = totalWidth2 - window.innerWidth;

      // Lave tween animation for wrappers
      const tween = gsap.to(wrappers, {
        x: -amountToScroll,
        delay: 5,
        ease: "none",
      });
      const tween2 = gsap.to(wrapper2, {
        x: -amountToScroll2,
        ease: "none",
      });

      //  Scrolltrigger for hver af containersne
      ScrollTrigger.create({
        animation: tween,
        trigger: ".common",
        start: "top top",
        end: "+=" + scrollDistance,
        scrub: 3,
        pin: true,
        // markers: true,
        pinSpacing: true,
      });
      ScrollTrigger.create({
        animation: tween2,
        trigger: ".common",
        start: "bottom bottom",
        end: "+=" + scrollDistance,
        scrub: 3,
        pin: true,
        pinSpacing: true,
      });
    }
    // tester
  );
</script>

<style>
  /*--------------------------- Galleri Mobile ----------------------------*/
  .gallery-container,
  .gallery-container2 {
    display: flex;
    flex-wrap: nowrap;
    overflow: hidden;
    position: relative;
    margin: 0; /* Ingen margin i top og bund */
    padding: 0; /* Ingen padding */
  }

  .wrapper,
  .wrapper2 {
    display: flex;
    width: 100vw;
    height: 50vh;
    padding: 0;
    margin: 0;
    flex-shrink: 0;
    overflow: hidden;
  }

  .galleryIMG {
    display: block;
    width: 100%;
    height: auto;
    overflow: hidden;
    object-fit: cover;
  }

  .presentFisk {
    height: 120vh;
    max-width: 80%;
    object-fit: cover;
  }

  @media (min-width: 800px) {
    /* ---------------------- Galleri Desktop ----------------------*/
    .common {
      display: flex;
      flex-direction: column;
      padding-top: var(--RA-size-64);
      padding: 0;
      position: relative;
    }

    .wrapper,
    .wrapper2 {
      display: flex;
      width: 50vw;
      height: 50vh;
      padding: 0;
      margin: 0;
      flex-shrink: 0;
      overflow: hidden;
    }

    .galleryIMG {
      display: block;
      width: 100%;
      height: auto;
      overflow: hidden;
      object-fit: cover;
    }

    .pigeFisk {
      width: 100%;
      height: 50vh;
      object-fit: cover;
    }
    .next-section {
      height: 100vh;
      background-color: #f0f0f0;
      display: flex;
      justify-content: center;
      align-items: center;
    }
    /* ---------------------------------------------------------------- */
  }
</style>
